"use strict";(self["webpackChunksisge"]=self["webpackChunksisge"]||[]).push([[4314],{44314:function(t,e,r){r.r(e),r.d(e,{default:function(){return V}});var a=function(){var t=this,e=t._self._c;return e("section",{staticClass:"pc-container pb-4"},[e("div",{staticClass:"pcoded-content"},[e("div",{staticClass:"row mb-4 d-flex justify-content-between"},[e("div",{staticClass:"col-sm-12 col-md-6 col-xl-7"},[e("h5",{staticClass:"text-dark fw-bold"},[e("button",{staticClass:"btn btn-sm mr-2 btn-primary",on:{click:t.goBack}},[e("i",{attrs:{"data-feather":"arrow-left"}})]),t._v("Busqueda de expedientes administrativos ")])]),e("div",{staticClass:"col-sm-12 col-md-6 col-xl-2",on:{click:t.download}},[e("button",{staticClass:"btn btn-success btn-lg",attrs:{type:"button"}},[t._v("Descargar Excel")])]),e("div",{staticClass:"col-sm-12 col-md-6 col-xl-3"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.anio,expression:"anio"}],staticClass:"form-control",on:{change:[function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.anio=e.target.multiple?r:r[0]},function(e){return t.mostrarTradesAnio()}]}},t._l(t.anios,(function(r,a){return e("option",{key:a,staticClass:"py-3",domProps:{value:r}},[t._v(" "+t._s(r)+" ")])})),0)])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-xl-12"},[e("div",{staticClass:"card shadow"},[e("div",{staticClass:"card-body"},[e("div",{staticClass:"table-responsive"},[e("table",{ref:"dataTable",staticClass:"table",attrs:{id:"table"}},[t._m(0),e("tbody",t._l(t.tradesAnio,(function(r){return e("tr",{key:r.tra_id},[e("td",[e("router-link",{attrs:{to:{name:"oficio/detalle",params:{id:r.tra_id}}}},[t._v(" "+t._s(r.tra_number)+" ")])],1),e("td",[t._v(t._s(r.area.are_name))]),e("td",[t._v(t._s(t.formatDate(r.tra_arrival_date)))]),e("td",[t._v(t._s(t.referencias(r.tra_exp_ext,r.tra_doc_recep))+" ")]),e("td",[t._v(t._s(r&&r.report&&r.report.rep_oficio?r.report.rep_oficio:"---"))]),e("td",[t._v(t._s(r&&r.report&&r.report.rep_informe?r.report.rep_informe:"---")+" ")]),"P"===r.tra_state_law?e("td",{staticClass:"pr-5"},[e("span",{class:t.badgeClassOficio(r.tra_state_law)},[t._v(" Pendiente ")])]):t._e(),"F"===r.tra_state_law?e("td",{staticClass:"pr-5"},[e("span",{class:t.badgeClassOficio(r.tra_state_law)},[t._v(" Terminado ")])]):t._e()])})),0)])])])])])])])])},n=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th",[t._v("N° de expediente")]),e("th",[t._v("Área de origen")]),e("th",[t._v("Fecha")]),e("th",[t._v("Referencias")]),e("th",[t._v("Oficio")]),e("th",[t._v("Informe")]),e("th",[t._v("Estado")])])])}],o=(r(44114),r(25800)),i=r(90740),c=r.n(i),s=r(49148),l=r.n(s);function u(t){return"[object Array]"===Object.prototype.toString.call(t)}function d(t,e){if(!t)throw new Error(e)}function f(t){return Object.keys(t)}function p(t){return Object.keys(t).map((function(e){return[e,t[e]]}))}function v(t,e,r){var a="."+e,n=new RegExp("(\\".concat(e,")?$"));return r(t).replace(n,a)}function h(t){return"555xmlHello .  world!".trim().replace(/^([0-9,;]|(xml))+/,""),t.replace(/[^_a-zA-Z 0-9:\-\.]/g,"").replace(/^([ 0-9-:\-\.]|(xml))+/i,"").replace(/ +/g,"-")}function m(t){return Array(t+1).join(" ")}function b(t){return t.replace(/([<>&])/g,(function(t,e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return""}}))}r(14603),r(47566),r(98721);function _(t,e,r){switch(e){case"txt":var a="text/plain;charset=utf-8";return r?URL.createObjectURL(new Blob([t],{type:a})):"data:,".concat(a)+encodeURIComponent(t);case"css":a="text/css;charset=utf-8";return r?URL.createObjectURL(new Blob([t],{type:a})):"data:,".concat(a)+encodeURIComponent(t);case"html":a="text/html;charset=utf-8";return r?URL.createObjectURL(new Blob([t],{type:a})):"data:,".concat(a)+encodeURIComponent(t);case"json":a="text/json;charset=utf-8";return r?URL.createObjectURL(new Blob([t],{type:a})):"data:,".concat(a)+encodeURIComponent(t);case"csv":a="text/csv;charset=utf-8";return r?URL.createObjectURL(new Blob([t],{type:a})):"data:,".concat(a)+encodeURIComponent(t);case"xls":a="text/application/vnd.ms-excel;charset=utf-8";return r?URL.createObjectURL(new Blob([t],{type:a})):"data:,".concat(a)+encodeURIComponent(t);case"xml":a="text/application/xml;charset=utf-8";return r?URL.createObjectURL(new Blob([t],{type:a})):"data:,".concat(a)+encodeURIComponent(t);default:return""}}function y(t,e,r,a){void 0===r&&(r="download"),void 0===a&&(a=!0);var n=_(t,e,a),o=document.createElement("a");o.href=n,o.download=r,o.setAttribute("style","visibility:hidden"),document.body.appendChild(o),o.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!1,view:window})),document.body.removeChild(o)}var x=function(){return x=Object.assign||function(t){for(var e,r=1,a=arguments.length;r<a;r++)for(var n in e=arguments[r],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},x.apply(this,arguments)},w=function(t,e){var r="function"===typeof Symbol&&t[Symbol.iterator];if(!r)return t;var a,n,o=r.call(t),i=[];try{while((void 0===e||e-- >0)&&!(a=o.next()).done)i.push(a.value)}catch(c){n={error:c}}finally{try{a&&!a.done&&(r=o["return"])&&r.call(o)}finally{if(n)throw n.error}}return i};function g(t){if(!t||u(t)&&!t.length||!u(t)&&!f(t).length)return function(t){return t};var e=u(t)?t.reduce((function(t,e){var r;return x(x({},t),(r={},r[e]=e,r))}),Object.create(null)):t;return function(t){return u(t)?t.map((function(t){return p(t).reduce((function(t,r){var a=w(r,2),n=a[0],o=a[1];return n in e&&(t[e[n]]=o),t}),Object.create(null))})).filter((function(t){return f(t).length})):p(t).reduce((function(t,r){var a=w(r,2),n=a[0],o=a[1];return n in e&&(t[e[n]]=o),t}),Object.create(null))}}function C(t){var e="Invalid export data. Please provide a valid JSON";try{return"string"===typeof t?JSON.parse(t):t}catch(r){throw new Error(e)}}function j(t,e,r){void 0===e&&(e=null);var a="Invalid export data. Please provide valid JSON object";try{return JSON.stringify(t,e,r)}catch(n){throw new Error(a)}}function T(t){return t.map(p).reduce((function(e,r,a){return r.reduce((function(e,r){var n=w(r,2),o=n[0],i=n[1],c=e[o]||Array.from({length:t.length}).map((function(t){return""}));return c[a]=("string"!==typeof i?JSON.stringify(i):i)||"",e[o]=c,e}),e)}),Object.create(null))}function O(t,e){return void 0===e&&(e=function(t){return t}),e(p(t).map((function(t){var e=w(t,2),r=e[0],a=e[1];return{fieldName:r,fieldValues:a}})))}function A(t,e){var r=new RegExp("".concat(e,'|"|\n')),a=r.test(t)?'"':"",n=t.replace(/"/g,'""');return"".concat(a).concat(n).concat(a)}var R={beforeTableEncode:function(t){return t},delimiter:","};function E(t,e){void 0===e&&(e={});var r=x(x({},R),e),a=r.beforeTableEncode,n=r.delimiter;if(!t.length)return"";var o=T(t),i=O(o,a),c=i.map((function(t){var e=t.fieldName;return e})).join(n)+"\r\n",s=i.map((function(t){var e=t.fieldValues;return e})).map((function(t){return t.map((function(t){return A(t,n)}))})),l=s.reduce((function(t,e){return t.map((function(t,r){return"".concat(t).concat(n).concat(e[r])}))}));return c+l.join("\r\n")}function U(t,e){d(t.length>0);var r=T(t),a=O(r,e),n=a.map((function(t){var e=t.fieldName;return e})).join("</b></th><th><b>"),o=a.map((function(t){var e=t.fieldValues;return e})).map((function(t){return t.map((function(t){return"<td>".concat(t,"</td>")}))})),i=o.reduce((function(t,e){return t.map((function(t,r){return"".concat(t).concat(e[r])}))}));return"\n    <table>\n      <thead>\n        <tr><th><b>".concat(n,"</b></th></tr>\n      </thead>\n      <tbody>\n        <tr>").concat(i.join("</tr>\n        <tr>"),"</tr>\n      </tbody>\n    </table>\n  ")}var k={beforeTableEncode:function(t){return t}};function D(t,e){var r=x(x({},k),e).beforeTableEncode;if(!t.length)return"";var a='<html>\n  <head>\n    <meta charset="UTF-8" />\n  </head >\n  <body>\n    '.concat(U(t,r),"\n  </body>\n</html >\n");return a}function L(t){var e='<?xml version="1.0" encoding="utf-8"?><!DOCTYPE base>\n'.concat(N(t,"base"),"\n");return e}function N(t,e,r,a){void 0===r&&(r="element"),void 0===a&&(a=0);var n=h(e),o=m(a);if(null===t||void 0===t)return"".concat(o,"<").concat(n," />");var i=u(t)?t.map((function(t){return N(t,r,r,a+2)})).join("\n"):"object"===typeof t?p(t).map((function(t){var e=w(t,2),n=e[0],o=e[1];return N(o,n,r,a+2)})).join("\n"):o+"  "+b(String(t)),c="".concat(o,"<").concat(n,">\n").concat(i,"\n").concat(o,"</").concat(n,">");return c}var B={txt:"txt",css:"css",html:"html",json:"json",csv:"csv",xls:"xls",xml:"xml"};function I(t){var e=t.data,r=t.fileName,a=void 0===r?"download":r,n=t.extension,o=t.fileNameFormatter,i=void 0===o?function(t){return t.replace(/\s+/,"_")}:o,c=t.fields,s=t.exportType,l=void 0===s?"txt":s,f=t.replacer,p=void 0===f?null:f,h=t.space,m=void 0===h?4:h,b=t.processor,_=void 0===b?y:b,x=t.withBOM,w=void 0!==x&&x,T=t.beforeTableEncode,O=void 0===T?function(t){return t}:T,A=t.delimiter,R=void 0===A?",":A,U="Invalid export data. Please provide an array of objects",k="Can't export unknown data type ".concat(l,"."),N="Can't export string data to ".concat(l,".");if("string"===typeof e)switch(l){case"txt":case"css":case"html":return _(e,l,v(a,null!==n&&void 0!==n?n:l,i));default:throw new Error(N)}var B=g(c),I=B(C(e)),$=j(I,p,m);switch(l){case"txt":case"css":case"html":return _($,l,v(a,null!==n&&void 0!==n?n:l,i));case"json":return _($,l,v(a,null!==n&&void 0!==n?n:"json",i));case"csv":d(u(I),U);var P="\ufeff",S=E(I,{beforeTableEncode:O,delimiter:R}),F=w?P+S:S;return _(F,l,v(a,null!==n&&void 0!==n?n:"csv",i));case"xls":d(u(I),U);F=D(I,{beforeTableEncode:O});return _(F,l,v(a,null!==n&&void 0!==n?n:"xls",i));case"xml":F=L(I);return _(F,l,v(a,null!==n&&void 0!==n?n:"xml",i));default:throw new Error(k)}}I.types=B,I.processors={downloadFile:y};var $=I,P=$,S=r(46587),F={name:"Buscar",mounted(){this.$nextTick((()=>{c().replace()})),this.cargarAños(),this.cargarTrades()},data(){return{anio:"",anios:[],trades:[],dataTable:null,exp:{},idTrade:null,showModal:"",tradesAnio:[]}},computed:{mostrarTradesAnio(){const t=parseInt(this.anio);return this.tradesAnio=[],this.tradesAnio=this.trades.filter((e=>e.anio===t)),this.initDataTable(),this.tradesAnio}},methods:{async"cargarAños"(){this.$showLoadingAlert();const t=(new Date).getFullYear();for(let e=t;e>=2022;e--)this.anios.push(e);this.anio=this.anios[0]},async cargarTrades(){try{const t=await this.$getData("trade",this);this.trades=t.data,this.tradesAnio=this.trades.filter((t=>t.anio===this.anio)),this.initDataTable(),this.$closeLoadingAlert()}catch(t){this.$handleApiError(t,"cargar oficios")}},async initDataTable(){this.destroyDataTable(),await this.$nextTick(),this.dataTable=S(this.$refs.dataTable).DataTable({language:{url:"//cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json"}})},referencias(t,e){var r="";return r=null!==t&null!==e?t+" / "+e:null!==t&null===e?t:null===t&null!==e?e:"---",r},destroyDataTable(){this.dataTable&&this.dataTable.destroy()&&(this.dataTable=null)},download(){const t=this.tradesAnio.map((t=>({"N° de expediente":t.tra_number,"Fecha de registro":this.formatDate(t.tra_arrival_date),"Atendido por":t.lawyer.persona.nat_nombres+t.lawyer.persona.nat_apellido_paterno+t.lawyer.persona.nat_apellido_materno,"Derivado a abogado":t.tra_der_date?t.tra_der_date:"No ha sido derivado aún",Asunto:t.tra_matter,Notas:t.tra_name?t.tra_name:"---","Área de origen":t.area.are_name,"Referencia->Expediente":t.tra_exp_ext?t.tra_exp_ext:"---","Referencia->Oficio":t.tra_doc_recep?t.tra_doc_recep:"---",Oficio:t&&t.report&&t.report.rep_oficio?t.report.rep_oficio:"---",Informe:t&&t.report&&t.report.rep_informe?t.report.rep_informe:"---",Estado:"P"===t.tra_state_law?"Pendiente":"Terminado"}))),e="Expedientes-Administrativo-"+this.anio,r=P.types.xls;P({data:t,fileName:e,exportType:r})},formatDate(t){return l().locale("es"),l()(t).format("DD MMM YYYY")},goBack(){"ABOGADO"===this.$store.getters.get__user.usu_rol?this.$router.push({path:"/oficio/asignados"}):this.$router.go(-1)},badgeClassOficio:o.H1}},M=F,Y=r(81656),J=(0,Y.A)(M,a,n,!1,null,"3a4c81f2",null),V=J.exports}}]);
//# sourceMappingURL=4314.f07f3310.js.map