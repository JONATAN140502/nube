"use strict";(self["webpackChunklegalcase"]=self["webpackChunklegalcase"]||[]).push([[4],{54004:function(a,e,t){t.r(e),t.d(e,{default:function(){return u}});var s=function(){var a=this,e=a._self._c;return e("section",{staticClass:"pc-container pb-4"},[e("div",{staticClass:"pcoded-content"},[a._m(0),e("div",{staticClass:"row"},[e("div",{staticClass:"col-xl-12"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[e("div",{staticClass:"row mb-3"},[e("div",{staticClass:"col-md-4 col-sm-12"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[a._v("Lista de abogados")]),e("select",{directives:[{name:"model",rawName:"v-model",value:a.abogado_asignado,expression:"abogado_asignado"}],staticClass:"form-control fade-transition",on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,(function(a){return a.selected})).map((function(a){var e="_value"in a?a._value:a.value;return e}));a.abogado_asignado=e.target.multiple?t:t[0]}}},[e("option",{attrs:{value:"",disabled:"",selected:""}},[a._v("Seleccionar")]),a._l(a.lawyers,(function(t){return e("option",{domProps:{value:t.abo_id}},[a._v(" "+a._s(a.completeNames(t))+" ")])}))],2)])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label",attrs:{for:"letras"}},[a._v("Escriba las letras a asignar")]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.letraInput,expression:"letraInput"}],staticClass:"form-control mb-3",attrs:{type:"text",placeholder:"Ingrese una letra"},domProps:{value:a.letraInput},on:{keydown:[a.limitarUnaLetra,function(e){return!e.type.indexOf("key")&&a._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),a.agregarLetra.apply(null,arguments))}],input:[function(e){e.target.composing||(a.letraInput=e.target.value)},a.validarYConvertirLetra]}})])]),e("div",{staticClass:"col-md-4 col-sm-4",staticStyle:{"margin-top":"27.5px !important"}},[e("div",{staticClass:"d-flex justify-content-end"},[e("button",{staticClass:"btn btn-success px-4 rounded btn-lg",on:{click:a.asignarExpedientes}},[a._v("Asignar")])])])]),e("div",{staticClass:"row mb-3"},[a._m(1),e("div",{staticClass:"col-sm-6 col-md-auto"},[a.letrasSeleccionadas.length>0?e("div",{staticStyle:{"margin-top":"-7.5px"}},a._l(a.letrasSeleccionadas,(function(t,s){return e("span",{key:s,class:{"letra-seleccionada":!0,duplicada:a.letraEsDuplicada(t)},on:{click:function(e){return a.quitarLetra(s)}}},[a._v(" "+a._s(t)+" ")])})),0):e("p",{staticClass:"text-secondary"},[a._v("No hay letras seleccionadas.")])]),a.letrasSeleccionadas.length>0?e("div",{staticClass:"col-md-auto ml-auto"},[e("p",{staticClass:"text-danger"},[a._v(a._s(a.contadorExpedientesFiltrados)+" expedientes encontrados")])]):a._e()]),e("div",{staticClass:"table-responsive"},[e("table",{ref:"myDataTable",staticClass:"table",attrs:{id:"table"}},[a._m(2),e("tbody",a._l(a.expedientesFiltrados,(function(t,s){return e("tr",{key:s},[e("td",[a._v(a._s(s+1))]),e("td",[e("router-link",{attrs:{to:{name:"expediente/detalle",params:{id:t.exp_id}}}},[a._v(" "+a._s(t.numero)+" ")])],1),e("td",[a._v(a._s(t.fecha_inicio))]),e("td",[a._v(a._s(a.isDemandante(t.procesal,t.multiple)))]),e("td",[a._v(a._s(t.materia))]),e("td",[a._v(a._s(t.pretencion))]),e("td",[e("span",{class:a.badgeClass(t.estado_proceso)},[a._v(" "+a._s(t.estado_proceso)+" ")])])])})),0)])])])])])])])])},i=[function(){var a=this,e=a._self._c;return e("div",{staticClass:"row mb-4"},[e("h5",{},[e("span",{staticClass:"text-primary"},[a._v("Asignacion de abogados a expedientes")])])])},function(){var a=this,e=a._self._c;return e("div",{staticClass:"col-md-auto"},[e("p",[a._v("Letras a asignar al abogado: ")])])},function(){var a=this,e=a._self._c;return e("thead",[e("tr",[e("th",[a._v("#")]),e("th",[a._v("N° de Expediente")]),e("th",[a._v("Fecha de Inicio")]),e("th",[a._v("Parte procesal")]),e("th",[a._v("Materia/Delito")]),e("th",[a._v("Pretensión")]),e("th",[a._v("Estado")])])])}],r=(t(44114),t(59911)),l=t.n(r),n=t(2637),o=t(25800),d={name:"abogado",mixins:[n.A],created(){this.loadSelectedOptions(),this.cargarExpedientes()},beforeDestroy(){this.saveSelectedOptions(),this.clearLocalStorage()},mounted(){this.$nextTick((()=>{l().replace()}))},data(){return{dataTable:null,abogado_asignado:"",assignedAttorney:"",newlawyer:"",lawyersWithFiles:null,lawyers:null,expedientes:[],isLoading:!1,letraInput:"",letrasSeleccionadas:[],letraDuplicada:null,parpadeoInterval:null,nombreAbogado:"",name:""}},computed:{letraInputMayuscula(){return this.letraInput.toUpperCase()},expedientesFiltrados(){if(0===this.letrasSeleccionadas.length)return this.expedientes;{const a=this.letrasSeleccionadas.map((a=>a.toUpperCase()));return this.expedientes.filter((e=>{const t=e.procesal[0].apellido_paterno||"",s=t.charAt(0).toUpperCase();return a.includes(s)}))}},contadorExpedientesFiltrados(){return this.expedientesFiltrados.length}},methods:{limitarUnaLetra(a){this.letraInput.length>=1&&"Backspace"!==a.key&&a.preventDefault()},validarYConvertirLetra(){const a=this.letraInput.charAt(0).toUpperCase();/^[A-Z]$/.test(a)?this.letraInput=a:this.letraInput="",this.letraDuplicada=null,this.parpadeoInterval&&clearInterval(this.parpadeoInterval)},agregarLetra(){if(/^[A-Z]$/.test(this.letraInput)){const a=this.letraInput;this.letrasSeleccionadas.includes(a)?(this.letraDuplicada=a,this.letraInput="",this.iniciarParpadeo(),setTimeout((()=>{this.letraDuplicada=null,this.detenerParpadeo()}),2e3)):(this.letrasSeleccionadas.push(a),console.log(this.letrasSeleccionadas),this.letraInput="")}},quitarLetra(a){this.letrasSeleccionadas.splice(a,1)},letraEsDuplicada(a){return this.letraDuplicada===a},iniciarParpadeo(){let a="#EA4D4D",e="#FF0000",t=!0;this.parpadeoInterval=setInterval((()=>{t=!t,document.querySelectorAll(".letra-seleccionada.duplicada").forEach((s=>{s.style.backgroundColor=t?a:e}))}),500)},detenerParpadeo(){clearInterval(this.parpadeoInterval),document.querySelectorAll(".letra-seleccionada.duplicada").forEach((a=>{a.style.backgroundColor="#7267EF"}))},saveSelectedOptions(){localStorage.setItem("assignedAttorney",this.assignedAttorney),localStorage.setItem("newlawyer",this.newlawyer)},loadSelectedOptions(){const a=localStorage.getItem("assignedAttorney"),e=localStorage.getItem("newlawyer");null!==a&&null!==e&&(this.assignedAttorney=a,this.newlawyer=e)},clearLocalStorage(){localStorage.removeItem("assignedAttorney"),localStorage.removeItem("newlawyer")},completeNames(a){return this.nombreAbogado=`${a.nat_nombres} ${a.nat_apellido_paterno} ${a.nat_apellido_materno}`,`${a.nat_nombres} ${a.nat_apellido_paterno} ${a.nat_apellido_materno}`},delay(a){return new Promise((e=>setTimeout(e,a)))},isValidSelection(){return"default_value"!==this.assignedAttorney&&"default_value"!==this.newlawyer},async listLawyers(){try{this.$showLoadingAlert();const a=await this.$getData("lawyer",this);this.lawyers=a.data,this.lawyersWithFiles=a.data.filter((a=>a.abo_carga_laboral>0)),this.$closeLoadingAlert()}catch(a){this.$handleApiError(a,"cargar abogados")}},async namea(a){const e=this.lawyers.find((e=>e.abo_id===a));this.name=e?`${e.nat_nombres} ${e.nat_apellido_paterno} ${e.nat_apellido_materno}`:""},asignarExpedientes(){if(""!==this.abogado_asignado&&0!==this.letrasSeleccionadas.length)try{this.namea(this.abogado_asignado),this.$warningAlertWithCancel("Asignación de abogado",`Confirmar asignación de expedientes al abogado ${this.name}?`,this.confirmarAsignacion)}catch(a){this.$handleApiError(a,a.message)}else this.$warnignAlert("","Seleccione un abogado y las letras a asignar.")},async confirmarAsignacion(){try{this.$showLoadingAlert("","Asignando expedientes...");const a={abogado_asignado:this.abogado_asignado,letras_selecionadas:this.letrasSeleccionadas},e=await this.$postData("lawyer/changeOfLawyer",this,a);0===e.state&&(this.abogado_asignado="",this.letrasSeleccionadas=[])}catch(a){this.$handleApiError(a,a.message),this.$errorAlert("",a)}finally{this.$closeLoadingAlert()}},async saveChanges(){if(this.isValidSelection())try{this.$showLoadingAlert("","Procesando cambios");const a=this.expedientes.map((a=>a.exp_id)),e={expedientes:a,abogado_actual:this.assignedAttorney,abogado_nuevo:this.newlawyer},t=await this.$postData("lawyer/changeOfLawyer",this,e);0==t.state&&(await this.cargarExpedientes(),this.assignedAttorney="",this.newlawyer="",await this.delay(500),await this.listLawyers(),this.$closeLoadingAlert())}catch(a){this.$handleApiError(a,a.message)}else this.$warnignAlert("","Por favor, selecciona abogados válidos antes de guardar cambios.")},async cargarExpedientes(){try{this.$showLoadingAlert();const a=await this.$getData("proceeding",this);this.expedientes=a.data,console.log(a),await this.$waitForDataTableDraw(this,"myDataTable"),await this.listLawyers(),this.$closeLoadingAlert()}catch(a){this.$handleApiError(a,"cargar expedientes")}},isDemandante(a,e){return"DEMANDANTE"===a[0].tipo_procesal?this.nombreCompleto(a,e):"UNPRG"},isDemandado(a,e){return"DEMANDADO"===a[0].tipo_procesal?this.nombreCompleto(a,e):"UNPRG"},nombreCompleto(a,e){if("1"===e)return"Demanda Colectiva";const t=a[0].tipo_persona,{apellido_paterno:s,apellido_materno:i,nombres:r,razon_social:l}=a[0];return"NATURAL"===t?`${s} ${i} ${r}`:l},badgeClass:o.U7}},c=d,p=t(81656),h=(0,p.A)(c,s,i,!1,null,"794d51fc",null),u=h.exports},2637:function(a,e){e.A={methods:{async initDataTable(){this.destroyDataTable(),await this.$nextTick(),this.dataTable=$(this.$refs.myDataTable).DataTable({language:{url:"//cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json"}})},destroyDataTable(){this.dataTable&&this.dataTable.destroy()&&(this.dataTable=null)}},beforeDestroy(){this.destroyDataTable()}}}}]);
//# sourceMappingURL=4.4bd823d9.js.map