"use strict";(self["webpackChunklegalcase"]=self["webpackChunklegalcase"]||[]).push([[7032],{47032:function(t,a,e){e.r(a),e.d(a,{default:function(){return T}});var r=function(){var t=this,a=t._self._c;return null!=t.trade?a("div",{staticClass:"pc-container pb-4"},[a("div",{staticClass:"page-header"},[a("div",{staticClass:"page-block"},[a("div",{staticClass:"row align-items-center"},[a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"page-header-title"},[a("h5",{staticClass:"m-b-10"},[a("button",{staticClass:"btn btn-sm mr-2 btn-primary",on:{click:t.goBack}},[a("i",{attrs:{"data-feather":"arrow-left"}})]),t._v(" EXPEDIENTE ADMINISTRATIVO: "+t._s(t.trade?t.trade.tra_number:"---")+" ")])]),a("ul",{staticClass:"breadcrumb"},[a("li",{staticClass:"breadcrumb-item"},[a("button",{staticClass:"btn rounded border py-1 px-4 btn-outline-primary",class:{"btn-primary text-white":"1"===t.isVista},on:{click:function(a){return t.selectVista("1")}}},[t._v(" DATOS")])]),a("li",{staticClass:"breadcrumb-item"},[a("button",{staticClass:"btn rounded border py-1 px-4 btn-outline-primary",class:{"btn-primary text-white":"2"===t.isVista},on:{click:function(a){return t.selectVista("2")}}},[t._v(" ARCHIVOS")])]),a("li",{staticClass:"breadcrumb-item"},[a("button",{staticClass:"btn rounded border py-1 px-4 btn-outline-primary",class:{"btn-primary text-white":"3"===t.isVista},on:{click:function(a){return t.redirectActualizar()}}},[t._v(" ACTUALIZAR")])])])])])])]),a("div",{staticClass:"pcoded-content"},[t.trade?a("div",["1"===t.isVista?a("General",{attrs:{id:t.trade.tra_id}}):"2"===t.isVista?a("Archivos",{attrs:{id:t.trade.tra_id}}):t._e()],1):t._e()])]):t._e()},s=[],i=(e(44114),e(38280)),o=e(98355),l=e(90740),n=e.n(l),c=function(){var t=this,a=t._self._c;return a("div",[a("div",{staticClass:"row d-flex align-items-start"},[a("div",{staticClass:"col-md-4"},[a("div",{staticClass:"card support-bar overflow-hidden"},[null!=t.trade?a("div",{staticClass:"card-body pb-0"},["P"===t.trade.tra_state_law?a("label",{staticClass:"badge bg-light-warning mb-2"},[t._v("PENDIENTE DE INFORME")]):t._e(),"F"===t.trade.tra_state_law?a("label",{staticClass:"badge bg-light-success mb-2"},[t._v("ATENDIDO")]):t._e(),a("h2",{staticClass:"m-0"},[t._v(t._s(t.trade.tra_number))]),a("span",{staticClass:"text-primary"},[t._v(t._s(t.trade.tra_name))]),a("p",{staticClass:"mb-3 mt-3"},[t._v(t._s(t.trade.tra_matter))]),a("p",{staticClass:"fw-bold text-dark text-center rounded border",staticStyle:{"background-color":"#F0F7FF"}},[t._v("Área de origen")]),a("p",[a("i",{staticClass:"material-icons-two-tone text-primary"},[t._v("apartment")]),t._v(" "+t._s(t.trade.area.are_name))]),a("p",{staticClass:"fw-bold text-dark text-center rounded border",staticStyle:{"background-color":"#F0F7FF"}},[t._v(" Referencias -> "+t._s(t.trade.type_reference.type_name))]),null!=t.trade.tra_exp_ext?a("p",[a("i",{staticClass:"material-icons-two-tone text-primary"},[t._v("description")]),t._v(" "+t._s(t.trade.tra_exp_ext))]):t._e(),null!=t.trade.tra_doc_recep?a("p",[a("i",{staticClass:"material-icons-two-tone text-primary"},[t._v("article")]),t._v(" "+t._s(t.trade.tra_doc_recep))]):t._e()]):t._e(),a("hr",{staticClass:"mb-0"}),null!=t.trade?a("div",{staticClass:"card-footer border-0"},[a("div",{staticClass:"row text-center"},[a("div",{staticClass:"col"},[a("h4",{staticClass:"m-0"},[t._v(t._s(t.formatDate(t.trade.tra_arrival_date)))])])])]):t._e()])]),null!=t.trade?a("div",{staticClass:"col-md-4"},[null!=t.trade.report?a("div",{staticClass:"card support-bar overflow-hidden"},[null!=t.trade?a("div",{staticClass:"card-body pb-4"},[a("label",{staticClass:"badge bg-light-primary mb-2"},[t._v("OFICIO")]),a("h5",{staticClass:"m-0"},[a("i",{staticClass:"material-icons-two-tone text-primary"},[t._v(" description")]),t._v(" "+t._s(t.trade.report.rep_oficio))])]):t._e(),a("hr",{staticClass:"m-0"}),null!=t.trade?a("div",{staticClass:"card-body pb-4"},[a("label",{staticClass:"badge bg-light-primary mb-2"},[t._v("INFORME")]),a("h5",{staticClass:"m-0"},[a("i",{staticClass:"material-icons-two-tone text-primary"},[t._v(" description")]),t._v(" "+t._s(t.trade.report.rep_informe))])]):t._e(),a("hr",{staticClass:"m-0"}),null!=t.trade?a("div",{staticClass:"card-body pb-4"},[a("label",{staticClass:"badge bg-light-primary mb-2"},[t._v("DERIVADO A")]),a("h5",{staticClass:"m-0"},[a("i",{staticClass:"material-icons-two-tone text-primary"},[t._v("apartment")]),t._v(" "+t._s(t.trade.report.area.are_name))])]):t._e()]):a("div",{staticClass:"card support-bar overflow-hidden"},[null!=t.trade?a("div",{staticClass:"card-body pb-4"},[a("label",{staticClass:"badge bg-light-primary mb-4"},[t._v("REGISTRAR REPORTE")]),a("div",{staticClass:"form-group"},[a("label",{staticClass:"form-label"},[t._v("N° Oficio")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.datosgenerales.rep_oficio,expression:"datosgenerales.rep_oficio"}],staticClass:"form-control",class:{"has-error":t.errores.rep_oficio},attrs:{type:"text"},domProps:{value:t.datosgenerales.rep_oficio},on:{input:[function(a){a.target.composing||t.$set(t.datosgenerales,"rep_oficio",a.target.value)},function(a){return t.validarCampo("rep_oficio")}]}}),t.errores.rep_oficio?a("span",{staticClass:"error-message"},[t._v("Ingrese el número de oficio")]):t._e()]),a("div",{staticClass:"form-group"},[a("label",{staticClass:"form-label"},[t._v("N° Informe")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.datosgenerales.rep_informe,expression:"datosgenerales.rep_informe"}],staticClass:"form-control",class:{"has-error":t.errores.rep_informe},attrs:{type:"text"},domProps:{value:t.datosgenerales.rep_informe},on:{input:[function(a){a.target.composing||t.$set(t.datosgenerales,"rep_informe",a.target.value)},function(a){return t.validarCampo("rep_informe")}]}}),t.errores.rep_informe?a("span",{staticClass:"error-message"},[t._v("Ingrese el número de informe")]):t._e()]),a("div",{staticClass:"form-group"},[a("label",{staticClass:"form-label"},[t._v("Derivar a la oficina:")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.datosgenerales.rep_area,expression:"datosgenerales.rep_area"}],staticClass:"form-control",class:{"has-error":t.errores.rep_area},on:{change:[function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(t.datosgenerales,"rep_area",a.target.multiple?e:e[0])},function(a){return t.validarCampo("rep_area")}]}},[a("option",{staticClass:"py-5",attrs:{value:"",disabled:"",selected:""}},[t._v("-- Seleccione una opción ")]),t._l(t.areas,(function(e){return a("option",{key:e.are_id,staticClass:"py-3",domProps:{value:e.are_id}},[t._v(" "+t._s(e.are_name)+" ")])}))],2),t.errores.rep_area?a("span",{staticClass:"error-message"},[t._v("Seleccione una Ocifina.")]):t._e()]),a("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button"},on:{click:t.registrar}},[t._v("REGISTRAR")])]):t._e()])]):t._e(),null!=t.trade?a("div",{staticClass:"col-md-4"},[a("div",{staticClass:"card feed-card"},[t._m(0),a("div",{staticClass:"card-body py-3"},[a("div",{staticClass:"mb-3"},[t._m(1),t._v(" "+t._s(t.trade.lawyer.persona.nat_nombres)+" "+t._s(t.trade.lawyer.persona.nat_apellido_paterno)+" "+t._s(t.trade.lawyer.persona.nat_apellido_materno)+" ")])])]),t._m(2)]):t._e()])])},d=[function(){var t=this,a=t._self._c;return a("div",{staticClass:"card-header py-3"},[a("span",{staticClass:"fw-bold"},[t._v("RESPONSABLE")])])},function(){var t=this,a=t._self._c;return a("i",{staticClass:"material-icons-two-tone text-primary"},[a("span",{staticClass:"material-symbols-outlined"},[t._v(" gavel ")])])},function(){var t=this,a=t._self._c;return a("div",{staticClass:"card feed-card"},[a("div",{staticClass:"card-header py-3"},[a("span",{staticClass:"fw-bold"},[t._v("SOLICITANTES")])]),a("div",{staticClass:"card-body py-3"},[a("div",{staticClass:"row rounded",staticStyle:{"background-color":"#F0F7FF"}},[a("span",[t._v("DATA")])])])])}],p=e(2637),_=e(34061),u=e(49148),h=e.n(u),m={mixins:[p.A],data(){return{areas:[],dataTable:null,trade:null,persons:[],formattedDate:"",id:"",datosgenerales:{rep_informe:"",rep_oficio:"",rep_area:""},errores:{rep_informe:!1,rep_oficio:!1,rep_area:!1}}},created(){this.sector=this.$store.getters.get__sector,this.id=this.$route.params.id,this.cargarDetallesOficio(),this.listarAreas()},mounted(){this.$nextTick((()=>{n().replace()}))},methods:{async cargarDetallesOficio(){try{const t=await this.$getData(`trade/${this.id}`,this);this.trade=t.trade,this.persons=this.trade.persons,this.datosgenerales.rep_informe=this.getIniciales(),this.datosgenerales.rep_oficio=this.getIniciales()}catch(error){this.$handleApiError(error,"cargar detalles del expediente administrativo ",this.id)}},async listarAreas(){try{const t=await(0,_.bQ)("area",this);this.areas=t.data}catch(error){this.$handleApiError(error,"listar areas")}finally{this.$closeLoadingAlert()}},async registrar(){if(this.validarCampos())try{this.loader=!0;const t={rep_oficio:this.datosgenerales.rep_oficio,rep_informe:this.datosgenerales.rep_informe,rep_tra_id:this.trade.tra_id,rep_are_id:this.datosgenerales.rep_area},a=await this.$postData("report/create",this,t);"success"===a.state&&window.location.reload()}catch(error){console.error("Error en la función registrar:",error),error.response?console.error("Respuesta del servidor:",error.response.data):error.message&&console.error("Mensaje de error:",error.message),this.$handleApiError(error,"crear informe")}else console.log("error")},getIniciales(){const t=this.trade.lawyer.persona.nat_nombres+" "+this.trade.lawyer.persona.nat_apellido_paterno+" "+this.trade.lawyer.persona.nat_apellido_materno,a=t.split(" ");let e="";a.forEach((t=>{t.length>0&&(e+=t.charAt(0).toUpperCase())}));var r=new Date,s=r.getFullYear();return s+"-UNPRG-OAJ-"+e},validarCampo(t){this.errores[t]=""===this.datosgenerales[t]},validarCampos(){return Object.keys(this.errores).forEach((t=>{this.validarCampo(t,t)})),!Object.values(this.errores).some((t=>t))},formatDate(t){return h().locale("es"),h()(t).format("DD MMM YYYY")},goBack(){this.$router.go(-1)}}},v=m,b=e(81656),f=(0,b.A)(v,c,d,!1,null,"0606b484",null),C=f.exports,g=function(){var t=this,a=t._self._c;return null!==t.trade?a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-12"},[a("div",{staticClass:"card"},[t._m(0),a("div",{staticClass:"card-body"},[null===t.trade.tra_pdf?a("div",[a("p",{staticClass:"text-muted"},[t._v("Actualmente no hay un archivo para este expediente. "),a("a",{staticClass:"text-primary",attrs:{href:"javascript:void(0)"},on:{click:function(a){return t.abrirModal(1)}}},[t._v("Haga click para cargar el expediente.")])])]):a("div",{staticClass:"row"},[t._m(1)])]),1===t.showModal?a("div",{staticClass:"modal",on:{click:t.cerrarModal}},[a("div",{staticClass:"modal-content",on:{click:function(t){t.stopPropagation()}}},[t._m(2),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"mb-3"},[a("label",{staticClass:"form-label",attrs:{for:"NumeroExpediente"}},[t._v("Seleccionar Archivo")]),a("input",{ref:"fileInput",staticClass:"form-control",attrs:{type:"file",requeried:""},on:{change:t.onFileChange}})])]),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:function(a){return t.cerrarModal()}}},[t._v("Cerrar")]),a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(a){return t.guardarArchivo()}}},[t._v("Guardar")])])])]):t._e()])]),a("div",{staticClass:"col-sm-12"},[a("div",{staticClass:"card"},[t._m(3),a("div",{staticClass:"card-body"},[null===t.trade.tra_pdf?a("div",[a("p",{staticClass:"text-muted"},[t._v("Actualmente no hay un archivo para este expediente. "),a("a",{staticClass:"text-primary",attrs:{href:"javascript:void(0)"},on:{click:function(a){return t.abrirModal(2)}}},[t._v("Haga click para cargar el informe.")])])]):a("div",{staticClass:"row"},[t._m(4)])])])]),2===t.showModal?a("div",{staticClass:"modal",on:{click:t.cerrarModal}},[a("div",{staticClass:"modal-content",on:{click:function(t){t.stopPropagation()}}},[t._m(5),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"mb-3"},[a("label",{staticClass:"form-label",attrs:{for:"NumeroExpediente"}},[t._v("Seleccionar Archivo")]),a("input",{ref:"fileInput",staticClass:"form-control",attrs:{type:"file",requeried:""},on:{change:t.onFileChange}})])]),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:function(a){return t.cerrarModal()}}},[t._v("Cerrar")]),a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(a){return t.guardarArchivo()}}},[t._v("Guardar")])])])]):t._e()]):t._e()},y=[function(){var t=this,a=t._self._c;return a("div",{staticClass:"card-header"},[a("h5",[t._v("CARGAR EXPEDIENTE")])])},function(){var t=this,a=t._self._c;return a("div",{staticClass:"col-md-3"},[a("label",{staticClass:"form-label"},[t._v("Se cargo")])])},function(){var t=this,a=t._self._c;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("Nuevo Archivo EXPEDIENTE")])])},function(){var t=this,a=t._self._c;return a("div",{staticClass:"card-header"},[a("h5",[t._v("CARGAR INFORME")])])},function(){var t=this,a=t._self._c;return a("div",{staticClass:"col-md-3"},[a("label",{staticClass:"form-label"},[t._v("Se cargo")])])},function(){var t=this,a=t._self._c;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("Nuevo Archivo REPORTE")])])}],A=(e(46587),{name:"ArchivosOficio",data(){return{trade:null,showModal:0,number:"",doc_tipo:"",id:""}},mounted(){this.$nextTick((()=>{n().replace()})),this.cargarDetallesOficio()},async created(){this.id=this.$route.params.id},methods:{async cargarDetallesOficio(){try{const t=await this.$getData(`trade/${this.id}`,this);this.trade=t.trade}catch(error){this.$handleApiError(error,"cargar detalles del expediente administrativo ",this.id)}},async guardarArchivo(){if(this.selectedFile)try{this.$showLoadingAlert(),1===this.showModal?(this.number=this.trade.tra_number,this.doc_tipo="ADMINISTRATIVO"):(this.number=this.trade.report.rep_informe+this.trade.report.rep_oficio,this.doc_tipo="INFORME");const t={file:this.selectedFile,number:this.number,doc_tipo:this.doc_tipo};console.log(t),await o.A.post(`${this.$store.getters.get__url}/archivos/guardarArchivoAdm`,t,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+this.$store.getters.get__token}}),this.selectedFile=null,this.showModal=0,this.$closeLoadingAlert(),this.cargarDetallesExpediente()}catch(error){console.error(error)}else this.$handleApiError(error,"guardar expediente")},abrirModal(t){this.showModal=t},cerrarModal(){this.showModal=0},goBack(){this.$router.go(-1)},onFileChange(t){this.selectedFile=t.target.files[0];const a=t.target;this.archivoSeleccionado=a.files.length>0}}}),w=A,x=(0,b.A)(w,g,y,!1,null,"674a0990",null),E=x.exports,$={name:"DetallesOficio",props:["id"],components:{General:C,Archivos:E},data(){return{isVista:"1",dataTable:null,trade:null}},computed:{rol(){return this.$store.getters.get__user.usu_rol}},mounted(){this.cargarDetallesOficio(),this.$nextTick((()=>{n().replace()}))},methods:{...(0,i.i0)(["get","post"]),selectVista(t){this.isVista=t},showOption(...t){return t.includes(this.rol)},async cargarDetallesOficio(){this.$showLoadingAlert();try{const t=await o.A.get(`${this.$store.getters.get__url}/trade/${this.id}`,{headers:{Authorization:`Bearer ${this.$store.getters.get__token}`}});this.trade=t.data.trade}catch(error){this.$handleApiError(error,"cargar detalles del expediente administrativo",this.id)}},goBack(){"ABOGADO"===this.$store.getters.get__user.usu_rol?this.$router.push({path:"/oficio/asignados"}):this.$router.go(-1)}}},k=$,D=(0,b.A)(k,r,s,!1,null,"ecefab76",null),T=D.exports},2637:function(t,a,e){var r=e(46587);a.A={methods:{async initDataTable(){this.destroyDataTable(),await this.$nextTick(),this.dataTable=r(this.$refs.myDataTable).DataTable({language:{url:"//cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json"}})},destroyDataTable(){this.dataTable&&this.dataTable.destroy()&&(this.dataTable=null)}},beforeDestroy(){this.destroyDataTable()}}}}]);
//# sourceMappingURL=7032.b4fb886c.js.map