"use strict";(self["webpackChunklegalcase"]=self["webpackChunklegalcase"]||[]).push([[3875],{43875:function(a,t,i){i.r(t),i.d(t,{default:function(){return h}});var s=function(){var a=this,t=a._self._c;return t("section",{staticClass:"pc-container pb-4 px-4"},[t("div",{staticClass:"pcoded-content"},[t("div",{staticClass:"card"},[t("div",{staticClass:"card-header py-3"},[t("div",{staticClass:"d-flex align-items-center"},[t("h5",[a._v("Lista de Fiscalias")]),t("button",{staticClass:"btn btn-success btn-sm px-4 ml-auto rounded-1",on:{click:a.mostrarModal}},[a._v(" Nuevo ")])])]),t("div",{staticClass:"card-body"},[a._m(0),t("div",{staticClass:"row mb-3"},[t("div",{staticClass:"col-xl-3 col-lg-5 col-md-6"},[t("select",{directives:[{name:"model",rawName:"v-model",value:a.instancia.judis_id,expression:"instancia.judis_id"}],staticClass:"form-control",on:{change:[function(t){var i=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.instancia,"judis_id",t.target.multiple?i:i[0])},function(t){return a.leer()}]}},[t("option",{attrs:{value:"",disabled:"",selected:""}},[a._v("-- Seleccionar")]),a._l(a.distritos,(function(i){return t("option",{domProps:{value:i.judis_id}},[a._v(" "+a._s(i.judis_nombre)+" ")])}))],2)])]),t("div",{staticClass:"table-responsive"},[t("table",{ref:"myDataTable",staticClass:"table",attrs:{id:"table"}},[a._m(1),t("tbody",a._l(a.instancias,(function(i,s){return 2==i.type_id?t("tr",{key:s},[a._m(2,!0),t("td",[a._v(a._s(i.ins_nombre))]),t("td",{staticClass:"text-center"},[t("a",{staticClass:"text-primary px-2 py-1 btn-lg mx-1",attrs:{href:"javascript:void(0)"},on:{click:function(t){return a.editar(i.ins_id)}}},[a._m(3,!0)]),t("a",{staticClass:"px-2 py-1 btn-lg text-danger",attrs:{href:"javascript:void(0)"},on:{click:function(t){return a.borrar(i.ins_id)}}},[a._m(4,!0)])])]):a._e()})),0)])])])]),a.showModal?t("div",{staticClass:"modal",on:{click:a.cerrarModal}},[t("div",{staticClass:"modal-content card border-0",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"card-header"},[t("h5",{staticClass:"text-center"},[a._v(" "+a._s(a.instancia.ins_id?"Actualizar Fiscalia":"Registar Nueva Fiscalia")+" ")])]),t("div",{staticClass:"card-body mb-0 pb-0"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-12"},[t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label"},[a._v("Distrito Judicial")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.instancia.judis_id,expression:"instancia.judis_id"}],staticClass:"form-control",on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.instancia,"judis_id",t.target.multiple?i:i[0])}}},[t("option",{attrs:{value:"",disabled:"",selected:""}},[a._v("-- Seleccionar")]),a._l(a.distritos,(function(i){return t("option",{domProps:{value:i.judis_id}},[a._v(" "+a._s(i.judis_nombre)+" ")])}))],2),t("label",{staticClass:"form-label"},[a._v("Nombre")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.instancia.ins_nombre,expression:"instancia.ins_nombre"}],staticClass:"form-control",class:{"has-error":a.errores.ins_nombre},domProps:{value:a.instancia.ins_nombre},on:{input:[function(t){t.target.composing||a.$set(a.instancia,"ins_nombre",t.target.value)},function(t){return a.validarCampo("ins_nombre")}],keyup:function(t){return!t.type.indexOf("key")&&a._k(t.keyCode,"enter",13,t.key,"Enter")?null:a.guardar.apply(null,arguments)}}}),a.errores.ins_nombre?t("span",{staticClass:"error-message"},[a._v("Ingrese el nombre de la Fiscalia.")]):a._e()])])])]),t("div",{staticClass:"card-footer border-0 mt-0 pt-0"},[t("div",{staticClass:"d-flex justify-content-end"},[t("button",{staticClass:"btn btn-secondary btn-lg px-4 mx-2 rounded",on:{click:a.cerrarModal}},[a._v("Cerrar")]),t("button",{staticClass:"btn btn-primary btn-lg px-4 rounded",on:{click:a.guardar}},[a.isLoading?t("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}):t("span",[a._v(a._s(a.instancia.ins_id?"Actualizar":"Guardar"))])])])])])]):a._e()])])},e=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"row"},[t("label",{staticClass:"form-label"},[a._v("Seleccione un Distrito Judicial")])])},function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",{staticClass:"text-center pl-4 col-lg-2 col-sm-1"},[a._v("#")]),t("th",[a._v("Nombre")]),t("th",{staticClass:"text-center"},[a._v("Opciones")])])])},function(){var a=this,t=a._self._c;return t("td",{staticClass:"text-center py-2 my-0"},[t("input",{staticClass:"form-check-input me-1",attrs:{type:"checkbox",value:""}})])},function(){var a=this,t=a._self._c;return t("span",{},[t("i",{attrs:{"data-feather":"edit"}})])},function(){var a=this,t=a._self._c;return t("span",[t("i",{attrs:{"data-feather":"trash"}})])}],n=i(59911),r=i.n(n),c=i(2637),o={name:"instancias",mixins:[c.A],mounted(){this.cargardistritos()},updated(){r().replace()},data(){return{dataTable:null,showModal:!1,instancias:[],instancia:{ins_id:"",ins_nombre:"",judis_id:""},errores:{ins_nombre:!1},isLoading:!1,editingIndex:null,distritos:[]}},methods:{validarCampo(a){this.errores[a]=""===this.instancia[a]},validarCampos(){return Object.keys(this.errores).forEach((a=>{this.validarCampo(a,a)})),!Object.values(this.errores).some((a=>a))},async cargardistritos(){try{this.$showLoadingAlert();const a=await this.$getData("judicialdistrict",this);this.distritos=a.data,this.$closeLoadingAlert()}catch(a){this.$handleApiError(a,"cargar distritos judiciales")}},async leer(){try{this.$showLoadingAlert();const a={judis_id:this.instancia.judis_id},t=await this.$postData("fiscalia",this,a);this.instancias=t.data,this.initDataTable(),this.$closeLoadingAlert()}catch(a){this.$handleApiError(a,"cargar distritos judiciales")}},async actualizarTable(){try{const a=await this.$getData("instance",this);this.instancias=a.data,this.initDataTable()}catch(a){this.$handleApiError(a,"cargar instancias")}},async crear(){if(this.validarCampos())try{this.isLoading=!0;const a={judis_id:this.instancia.judis_id,ins_nombre:this.instancia.ins_nombre,tipo:2},t=await this.$postData("fiscalia/store",this,a);"success"===t.state&&(await this.actualizarTable(),this.isLoading=!1,this.cerrarModal())}catch(a){this.$handleApiError(a,"crear distrito judicial")}},async actualizar(a){if(this.validarCampos())try{this.isLoading=!0;const t={ins_id:a,ins_nombre:this.instancia.ins_nombre,judis_id:this.instancia.judis_id},i=await this.$putData("fiscalia/update",this,t),s=i.data;if("success"===i.state){const a=this.instancias.findIndex((a=>a.ins_id===this.instancia.ins_id));-1!==a&&this.$set(this.instancias,a,s),this.isLoading=!1,this.cerrarModal()}}catch(t){this.$handleApiError(t,"actualizar distrito judicial")}},async borrar(a){this.$warningAlertWithCancel("Confirmar Eliminación","¿Estás seguro de que deseas eliminar esta Instancia?",(async()=>{try{this.$showLoadingAlert("Eliminando","");const t={ins_id:a},i=await this.$deleteData("fiscalia/destroy",this,t);"success"===i.state&&(await this.actualizarTable(),this.$closeLoadingAlert())}catch(t){this.$closeLoadingAlert(),this.$handleApiError(t,t.message)}}),(()=>{console.log("Eliminar instancia cancelado")}))},editar(a){const t=this.instancias.find((t=>t.ins_id===a));t?(this.instancia={...t},this.showModal=!0):console.error("Instancia no encontrado")},guardar(){try{this.instancia.ins_id?this.actualizar(this.instancia.ins_id):this.crear()}catch(a){console.error(a)}},initDataTable(){this.dataTable&&this.dataTable.destroy(),this.$nextTick((()=>{this.dataTable=$("#table").DataTable({language:{url:"//cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json"}}),r().replace()}))},mostrarModal(){this.showModal=!0},cerrarModal(){this.showModal=!1,this.errores.ins_nombre=!1,this.instancia.ins_id="",this.instancia.ins_nombre="",this.instancia.judis_id=""}}},l=o,d=i(81656),u=(0,d.A)(l,s,e,!1,null,"25620136",null),h=u.exports},2637:function(a,t){t.A={methods:{async initDataTable(){this.destroyDataTable(),await this.$nextTick(),this.dataTable=$(this.$refs.myDataTable).DataTable({language:{url:"//cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json"}})},destroyDataTable(){this.dataTable&&this.dataTable.destroy()&&(this.dataTable=null)}},beforeDestroy(){this.destroyDataTable()}}}}]);
//# sourceMappingURL=3875.88adf6c2.js.map