"use strict";(self["webpackChunklegalcase"]=self["webpackChunklegalcase"]||[]).push([[9828],{59828:function(a,e,t){t.r(e),t.d(e,{default:function(){return u}});var s=function(){var a=this,e=a._self._c;return e("section",{staticClass:"pc-container pb-4"},[e("div",{staticClass:"pcoded-content"},[a._m(0),e("div",{staticClass:"row"},[e("div",{staticClass:"col-xl-12"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-body pt-5 px-5"},[e("div",{staticClass:"row mb-4"},[a._m(1),e("div",{staticClass:"col-md-4"},[e("select",{directives:[{name:"model",rawName:"v-model",value:a.abogado_asignado,expression:"abogado_asignado"}],staticClass:"form-control fade-transition",on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,(function(a){return a.selected})).map((function(a){var e="_value"in a?a._value:a.value;return e}));a.abogado_asignado=e.target.multiple?t:t[0]}}},[e("option",{attrs:{value:"",disabled:"",selected:""}},[a._v("Seleccionar")]),a._l(a.lawyers,(function(t){return e("option",{domProps:{value:t.abo_id}},[a._v(" "+a._s(a.completeNames(t))+" ")])}))],2)])]),e("div",{staticClass:"row mb-4"},[a._m(2),e("div",{staticClass:"col-md-4"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.letraInput,expression:"letraInput"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Ingrese hasta dos letras",maxlength:"2"},domProps:{value:a.letraInput},on:{input:[function(e){e.target.composing||(a.letraInput=e.target.value)},a.validarYConvertirLetra],keydown:function(e){return!e.type.indexOf("key")&&a._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),a.agregarLetra.apply(null,arguments))}}})])]),e("div",{staticClass:"row"},[a._m(3),e("div",{staticClass:"col-md-4 mt-2"},[a.letrasSeleccionadas.length>0?e("div",a._l(a.letrasSeleccionadas,(function(t,s){return e("span",{key:s,class:{"letra-seleccionada":!0,duplicada:a.letraEsDuplicada(t)},on:{click:function(e){return a.quitarLetra(s)}}},[a._v(" "+a._s(t)+" ")])})),0):e("div",[e("span",[a._v("No hay letras seleccionadas.")])])])])]),e("div",{staticClass:"card-footer px-5"},[e("div",{staticClass:"d-flex"},[e("button",{staticClass:"btn btn-success px-5 rounded btn-lg ml-auto",on:{click:a.asignarExpedientes}},[a._v("Asignar")])])])])])])])])},i=[function(){var a=this,e=a._self._c;return e("div",{staticClass:"row mb-4"},[e("h5",{},[e("span",{staticClass:"text-primary"},[a._v("Asignacion de abogados a expedientes")])])])},function(){var a=this,e=a._self._c;return e("div",{staticClass:"col-md-3 d-flex align-items-center"},[e("label",{staticClass:"form-label"},[a._v("Lista de abogados")])])},function(){var a=this,e=a._self._c;return e("div",{staticClass:"col-md-3 d-flex align-items-center"},[e("label",{staticClass:"form-label mt-2",attrs:{for:"letras"}},[a._v("Escriba las letras a asignar")])])},function(){var a=this,e=a._self._c;return e("div",{staticClass:"col-md-3 mt-2"},[e("label",{staticClass:"form-label"},[a._v("Letras a asignar al abogado: ")])])}],l=(t(44114),t(90740)),n=t.n(l),o=t(2637),r=t(25800),c={name:"abogado",mixins:[o.A],created(){this.loadSelectedOptions(),this.listLawyers()},beforeDestroy(){this.saveSelectedOptions(),this.clearLocalStorage()},mounted(){this.$nextTick((()=>{n().replace()}))},data(){return{dataTable:null,abogado_asignado:"",assignedAttorney:"",newlawyer:"",lawyersWithFiles:null,lawyers:null,expedientes:[],isLoading:!1,letraInput:"",letrasSeleccionadas:[],letraDuplicada:null,parpadeoInterval:null,nombreAbogado:"",name:"",alfabeto:"A,B,C,CH,D,E,F,G,H,I,J,K,L,LL,M,N,Ñ,O,P,Q,R,S,T,U,V,W,X,Y,Z"}},computed:{},methods:{validarYConvertirLetra(){const a=["A","B","C","CH","D","E","F","G","H","I","J","K","L","LL","M","N","Ñ","O","P","Q","R","S","T","U","V","W","X","Y","Z"];this.letraInput=this.letraInput.toUpperCase(),a.includes(this.letraInput)||(this.letraInput="")},agregarLetra(){const a=this.letraInput.toUpperCase();a.length>0&&this.alfabeto.includes(a)&&(this.letrasSeleccionadas.includes(a)?(this.letraDuplicada=a,this.letraInput="",this.iniciarParpadeo(),setTimeout((()=>{this.letraDuplicada=null,this.detenerParpadeo()}),2e3)):(this.letrasSeleccionadas.push(a),console.log(this.letrasSeleccionadas),this.letraInput=""))},quitarLetra(a){this.letrasSeleccionadas.splice(a,1)},letraEsDuplicada(a){return this.letraDuplicada===a},iniciarParpadeo(){let a="#EA4D4D",e="#FF0000",t=!0;this.parpadeoInterval=setInterval((()=>{t=!t,document.querySelectorAll(".letra-seleccionada.duplicada").forEach((s=>{s.style.backgroundColor=t?a:e}))}),500)},detenerParpadeo(){clearInterval(this.parpadeoInterval),document.querySelectorAll(".letra-seleccionada.duplicada").forEach((a=>{a.style.backgroundColor="#7267EF"}))},saveSelectedOptions(){localStorage.setItem("assignedAttorney",this.assignedAttorney),localStorage.setItem("newlawyer",this.newlawyer)},loadSelectedOptions(){const a=localStorage.getItem("assignedAttorney"),e=localStorage.getItem("newlawyer");null!==a&&null!==e&&(this.assignedAttorney=a,this.newlawyer=e)},clearLocalStorage(){localStorage.removeItem("assignedAttorney"),localStorage.removeItem("newlawyer")},completeNames(a){return this.nombreAbogado=`${a.nat_nombres} ${a.nat_apellido_paterno} ${a.nat_apellido_materno}`,`${a.nat_nombres} ${a.nat_apellido_paterno} ${a.nat_apellido_materno}`},delay(a){return new Promise((e=>setTimeout(e,a)))},isValidSelection(){return"default_value"!==this.assignedAttorney&&"default_value"!==this.newlawyer},async listLawyers(){try{this.$showLoadingAlert();const a=await this.$getData("lawyer",this);console.log(a),this.lawyers=a.data,this.lawyersWithFiles=a.data.filter((a=>a.abo_carga_laboral>0)),this.$closeLoadingAlert()}catch(a){this.$handleApiError(a,"cargar abogados")}},async namea(a){const e=this.lawyers.find((e=>e.abo_id===a));this.name=e?`${e.nat_nombres} ${e.nat_apellido_paterno} ${e.nat_apellido_materno}`:""},asignarExpedientes(){if(""!==this.abogado_asignado&&0!==this.letrasSeleccionadas.length)try{this.namea(this.abogado_asignado),this.$warningAlertWithCancel("Asignación de abogado",`Confirmar asignación de expedientes al abogado ${this.name}?`,this.confirmarAsignacion)}catch(a){this.$handleApiError(a,a.message)}else this.$warnignAlert("","Seleccione un abogado y las letras a asignar.")},async confirmarAsignacion(){try{this.$showLoadingAlert("","Asignando expedientes...");const a={abogado_asignado:this.abogado_asignado,letras_selecionadas:this.letrasSeleccionadas};console.log(a);const e=await this.$postData("lawyer/changeOfLawyer",this,a);console.log(e),0===e.state&&(this.abogado_asignado="",this.letrasSeleccionadas=[],this.$closeLoadingAlert(),this.$successAlert("Asignación Correcta!","Se han asignado"+e.cantidad+"expediente(s)."))}catch(a){this.$handleApiError(a,a.message),this.$errorAlert("",a)}},async saveChanges(){if(this.isValidSelection())try{this.$showLoadingAlert("","Procesando cambios");const a=this.expedientes.map((a=>a.exp_id)),e={expedientes:a,abogado_actual:this.assignedAttorney,abogado_nuevo:this.newlawyer},t=await this.$postData("lawyer/changeOfLawyer",this,e);0==t.state&&(await this.cargarExpedientes(),this.assignedAttorney="",this.newlawyer="",await this.delay(500),await this.listLawyers(),this.$closeLoadingAlert())}catch(a){this.$handleApiError(a,a.message)}else this.$warnignAlert("","Por favor, selecciona abogados válidos antes de guardar cambios.")},async cargarExpedientes(){try{const a=await this.$getData("proceeding",this);this.expedientes=a.data,console.log(a),await this.$waitForDataTableDraw(this,"myDataTable")}catch(a){this.$handleApiError(a,"cargar expedientes")}},isDemandante(a,e){return"DEMANDANTE"===a[0].tipo_procesal?this.nombreCompleto(a,e):"UNPRG"},isDemandado(a,e){return"DEMANDADO"===a[0].tipo_procesal?this.nombreCompleto(a,e):"UNPRG"},nombreCompleto(a,e){if("1"===e)return"Demanda Colectiva";const t=a[0].tipo_persona,{apellido_paterno:s,apellido_materno:i,nombres:l,razon_social:n}=a[0];return"NATURAL"===t?`${s} ${i} ${l}`:n},badgeClass:r.U7}},d=c,h=t(81656),p=(0,h.A)(d,s,i,!1,null,"09b77d30",null),u=p.exports},2637:function(a,e,t){var s=t(46587);e.A={methods:{async initDataTable(){this.destroyDataTable(),await this.$nextTick(),this.dataTable=s(this.$refs.myDataTable).DataTable({language:{url:"//cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json"}})},destroyDataTable(){this.dataTable&&this.dataTable.destroy()&&(this.dataTable=null)}},beforeDestroy(){this.destroyDataTable()}}}}]);
//# sourceMappingURL=9828.6553e90c.js.map