"use strict";(self["webpackChunklegalcase"]=self["webpackChunklegalcase"]||[]).push([[3875],{43875:function(t,a,i){i.r(a),i.d(a,{default:function(){return _}});var s=function(){var t=this,a=t._self._c;return a("section",{staticClass:"pc-container pb-4 px-4"},[a("div",{staticClass:"pcoded-content"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-header py-3"},[a("div",{staticClass:"d-flex align-items-center"},[a("h5",[t._v("Lista de Fiscalias")]),a("button",{staticClass:"btn btn-success btn-sm px-4 ml-auto rounded-1",on:{click:t.mostrarModal}},[t._v(" Nuevo ")])])]),a("div",{staticClass:"card-body"},[t._m(0),a("div",{staticClass:"row mb-3"},[a("div",{staticClass:"col-xl-3 col-lg-5 col-md-6"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.instancia.judis_id,expression:"instancia.judis_id"}],staticClass:"form-control",on:{change:[function(a){var i=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(t.instancia,"judis_id",a.target.multiple?i:i[0])},function(a){return t.leer()}]}},[a("option",{attrs:{value:"",disabled:"",selected:""}},[t._v("-- Seleccionar")]),t._l(t.distritos,(function(i){return a("option",{domProps:{value:i.judis_id}},[t._v(" "+t._s(i.judis_nombre)+" ")])}))],2)])]),a("div",{staticClass:"table-responsive"},[a("table",{ref:"myDataTable",staticClass:"table",attrs:{id:"table"}},[t._m(1),a("tbody",t._l(t.instancias,(function(i,s){return 2==i.type_id?a("tr",{key:s},[t._m(2,!0),a("td",[t._v(t._s(i.ins_nombre))]),a("td",{staticClass:"text-center"},[a("a",{staticClass:"text-primary px-2 py-1 btn-lg mx-1",attrs:{href:"javascript:void(0)"},on:{click:function(a){return t.editar(i.ins_id)}}},[t._m(3,!0)]),a("a",{staticClass:"px-2 py-1 btn-lg text-danger",attrs:{href:"javascript:void(0)"},on:{click:function(a){return t.borrar(i.ins_id)}}},[t._m(4,!0)])])]):t._e()})),0)])])])]),t.showModal?a("div",{staticClass:"modal",on:{click:t.cerrarModal}},[a("div",{staticClass:"modal-content card border-0",on:{click:function(t){t.stopPropagation()}}},[a("div",{staticClass:"card-header"},[a("h5",{staticClass:"text-center"},[t._v(" "+t._s(t.instancia.ins_id?"Actualizar Fiscalia":"Registar Nueva Fiscalia")+" ")])]),a("div",{staticClass:"card-body mb-0 pb-0"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"form-group"},[a("label",{staticClass:"form-label"},[t._v("Distrito Judicial")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.instancia.judis_id,expression:"instancia.judis_id"}],staticClass:"form-control",on:{change:function(a){var i=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(t.instancia,"judis_id",a.target.multiple?i:i[0])}}},[a("option",{attrs:{value:"",disabled:"",selected:""}},[t._v("-- Seleccionar")]),t._l(t.distritos,(function(i){return a("option",{domProps:{value:i.judis_id}},[t._v(" "+t._s(i.judis_nombre)+" ")])}))],2),a("label",{staticClass:"form-label"},[t._v("Nombre")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.instancia.ins_nombre,expression:"instancia.ins_nombre"}],staticClass:"form-control",class:{"has-error":t.errores.ins_nombre},domProps:{value:t.instancia.ins_nombre},on:{input:[function(a){a.target.composing||t.$set(t.instancia,"ins_nombre",a.target.value)},function(a){return t.validarCampo("ins_nombre")}],keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.guardar.apply(null,arguments)}}}),t.errores.ins_nombre?a("span",{staticClass:"error-message"},[t._v("Ingrese el nombre de la Fiscalia.")]):t._e()])])])]),a("div",{staticClass:"card-footer border-0 mt-0 pt-0"},[a("div",{staticClass:"d-flex justify-content-end"},[a("button",{staticClass:"btn btn-secondary btn-lg px-4 mx-2 rounded",on:{click:t.cerrarModal}},[t._v("Cerrar")]),a("button",{staticClass:"btn btn-primary btn-lg px-4 rounded",on:{click:t.guardar}},[t.isLoading?a("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}):a("span",[t._v(t._s(t.instancia.ins_id?"Actualizar":"Guardar"))])])])])])]):t._e()])])},e=[function(){var t=this,a=t._self._c;return a("div",{staticClass:"row"},[a("label",{staticClass:"form-label"},[t._v("Seleccione un Distrito Judicial")])])},function(){var t=this,a=t._self._c;return a("thead",[a("tr",[a("th",{staticClass:"text-center pl-4 col-lg-2 col-sm-1"},[t._v("#")]),a("th",[t._v("Nombre")]),a("th",{staticClass:"text-center"},[t._v("Opciones")])])])},function(){var t=this,a=t._self._c;return a("td",{staticClass:"text-center py-2 my-0"},[a("input",{staticClass:"form-check-input me-1",attrs:{type:"checkbox",value:""}})])},function(){var t=this,a=t._self._c;return a("span",{},[a("i",{attrs:{"data-feather":"edit"}})])},function(){var t=this,a=t._self._c;return a("span",[a("i",{attrs:{"data-feather":"trash"}})])}],n=i(90740),r=i.n(n),o=i(2637),c=i(46587),l={name:"instancias",mixins:[o.A],mounted(){this.cargardistritos()},updated(){r().replace()},data(){return{dataTable:null,showModal:!1,instancias:[],instancia:{ins_id:"",ins_nombre:"",judis_id:""},errores:{ins_nombre:!1},isLoading:!1,editingIndex:null,distritos:[]}},methods:{validarCampo(t){this.errores[t]=""===this.instancia[t]},validarCampos(){return Object.keys(this.errores).forEach((t=>{this.validarCampo(t,t)})),!Object.values(this.errores).some((t=>t))},async cargardistritos(){try{this.$showLoadingAlert();const t=await this.$getData("judicialdistrict",this);this.distritos=t.data,this.$closeLoadingAlert()}catch(t){this.$handleApiError(t,"cargar distritos judiciales")}},async leer(){try{this.$showLoadingAlert();const t={judis_id:this.instancia.judis_id},a=await this.$postData("fiscalia",this,t);this.instancias=a.data,this.initDataTable(),this.$closeLoadingAlert()}catch(t){this.$handleApiError(t,"cargar distritos judiciales")}},async actualizarTable(){try{const t=await this.$getData("instance",this);this.instancias=t.data,this.initDataTable()}catch(t){this.$handleApiError(t,"cargar instancias")}},async crear(){if(this.validarCampos())try{this.isLoading=!0;const t={judis_id:this.instancia.judis_id,ins_nombre:this.instancia.ins_nombre,tipo:2},a=await this.$postData("fiscalia/store",this,t);"success"===a.state&&(await this.actualizarTable(),this.isLoading=!1,this.cerrarModal())}catch(t){this.$handleApiError(t,"crear distrito judicial")}},async actualizar(t){if(this.validarCampos())try{this.isLoading=!0;const a={ins_id:t,ins_nombre:this.instancia.ins_nombre,judis_id:this.instancia.judis_id},i=await this.$putData("fiscalia/update",this,a),s=i.data;if("success"===i.state){const t=this.instancias.findIndex((t=>t.ins_id===this.instancia.ins_id));-1!==t&&this.$set(this.instancias,t,s),this.isLoading=!1,this.cerrarModal()}}catch(a){this.$handleApiError(a,"actualizar distrito judicial")}},async borrar(t){this.$warningAlertWithCancel("Confirmar Eliminación","¿Estás seguro de que deseas eliminar esta Instancia?",(async()=>{try{this.$showLoadingAlert("Eliminando","");const a={ins_id:t},i=await this.$deleteData("fiscalia/destroy",this,a);"success"===i.state&&(await this.actualizarTable(),this.$closeLoadingAlert())}catch(a){this.$closeLoadingAlert(),this.$handleApiError(a,a.message)}}),(()=>{console.log("Eliminar instancia cancelado")}))},editar(t){const a=this.instancias.find((a=>a.ins_id===t));a?(this.instancia={...a},this.showModal=!0):console.error("Instancia no encontrado")},guardar(){try{this.instancia.ins_id?this.actualizar(this.instancia.ins_id):this.crear()}catch(t){console.error(t)}},initDataTable(){this.dataTable&&this.dataTable.destroy(),this.$nextTick((()=>{this.dataTable=c("#table").DataTable({language:{url:"//cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json"}}),r().replace()}))},mostrarModal(){this.showModal=!0},cerrarModal(){this.showModal=!1,this.errores.ins_nombre=!1,this.instancia.ins_id="",this.instancia.ins_nombre="",this.instancia.judis_id=""}}},d=l,u=i(81656),h=(0,u.A)(d,s,e,!1,null,"25620136",null),_=h.exports},2637:function(t,a,i){var s=i(46587);a.A={methods:{async initDataTable(){this.destroyDataTable(),await this.$nextTick(),this.dataTable=s(this.$refs.myDataTable).DataTable({language:{lengthMenu:"Mostrar _MENU_ registros por página",zeroRecords:"No se encontraron resultados",info:"Mostrando _START_ a _END_ de _TOTAL_ registros",infoEmpty:"Mostrando 0 a 0 de 0 registros",infoFiltered:"(filtrado de _MAX_ registros totales)",search:"Buscar",paginate:{first:"Primero",last:"Último",next:"Siguiente",previous:"Anterior"}}})},destroyDataTable(){this.dataTable&&this.dataTable.destroy()&&(this.dataTable=null)}},beforeDestroy(){this.destroyDataTable()}}}}]);
//# sourceMappingURL=3875.b784ba15.js.map