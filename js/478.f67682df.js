"use strict";(self["webpackChunklegalcase"]=self["webpackChunklegalcase"]||[]).push([[478],{64478:function(e,t,a){a.r(t),a.d(t,{default:function(){return p}});var s=function(){var e=this,t=e._self._c;return t("section",{staticClass:"pc-container pb-4"},[t("div",{staticClass:"pcoded-content"},[e._m(0),t("div",{staticClass:"row"},[t("div",{staticClass:"col-xl-12"},[t("div",{staticClass:"card shadow"},[t("div",{staticClass:"card-body"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-4 col-sm-12"},[t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label"},[e._v("Abogados con expedientes asignados")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.assignedAttorney,expression:"assignedAttorney"}],staticClass:"form-control fade-transition",on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.assignedAttorney=t.target.multiple?a:a[0]},function(t){return e.listFiles()}]}},[t("option",{attrs:{value:"default_value",disabled:"",selected:""}},[e._v("Seleccionar")]),e._l(e.lawyersWithFiles,(function(a){return t("option",{domProps:{value:a.abo_id}},[e._v(" "+e._s(e.completeNames(a))+" ")])}))],2)])]),t("div",{staticClass:"col-md-4 col-sm-12"},[t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label"},[e._v("Nuevo abogado a asignar a los expedientes")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.newlawyer,expression:"newlawyer"}],staticClass:"form-control fade-transition",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.newlawyer=t.target.multiple?a:a[0]}}},[t("option",{attrs:{value:"default_value",disabled:"",selected:""}},[e._v("Seleccionar")]),e._l(e.lawyers,(function(a){return t("option",{domProps:{value:a.abo_id}},[e._v(" "+e._s(e.completeNames(a))+" ")])}))],2)])]),t("div",{staticClass:"col-md-4 col-sm-4",staticStyle:{"margin-top":"27.5px !important"}},[t("div",{staticClass:"d-flex justify-content-end"},[t("button",{staticClass:"btn btn-success px-4 rounded btn-lg",on:{click:e.saveChanges}},[e._v("Guardar")])])])]),t("div",{staticClass:"table-responsive"},[t("table",{staticClass:"table fade-transition",attrs:{id:"miTabla"}},[e._m(1),t("tbody",e._l(e.files,(function(a){return t("tr",{key:a.exp_id},[t("td",[t("router-link",{attrs:{to:{name:"expediente/detalle",params:{id:a.exp_id}}}},[e._v(" "+e._s(a.numero)+" ")])],1),t("td",[e._v(e._s(a.fecha_inicio))]),"demandante"===a.procesal?t("td",{staticClass:"col-md-1"},[e._v(e._s(e.getPersonaName(a))+" ")]):e._e(),t("td",[e._v("UNPRG")]),"demandado"===a.procesal?t("td",[e._v(e._s(e.getPersonaName(a))+" ")]):e._e(),t("td",[e._v(e._s(a.pretencion))]),t("td",[e._v(e._s(a.materia))]),t("td",[t("span",{class:e.badgeClass(a.estado_proceso)},[e._v(" "+e._s(a.estado_proceso)+" ")])])])})),0)])])])])])])])])},l=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"row pb-4"},[t("h5",{staticClass:"text-secondary"},[e._v("Modificación en la asignación de abogados a expedientes específicos")])])},function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("N° de Expediente")]),t("th",[e._v("Fecha de Inicio")]),t("th",[e._v("Demandante")]),t("th",[e._v("Demandado")]),t("th",[e._v("Pretensión")]),t("th",[e._v("Materia")]),t("th",[e._v("Estado")])])])}],o=a(98164),n=a.n(o),i=a(77387),r=a.n(i),d=(a(50563),a(22619),a(63822)),c={name:"abogado",created(){this.loadSelectedOptions(),this.listLawyers(),this.listFiles()},beforeDestroy(){this.saveSelectedOptions(),this.clearLocalStorage()},mounted(){this.$nextTick((()=>{n().replace()}))},data(){return{dataTable:null,assignedAttorney:"default_value",newlawyer:"default_value",lawyersWithFiles:null,lawyers:null,files:null}},methods:{...(0,d.nv)(["get","post"]),saveSelectedOptions(){localStorage.setItem("assignedAttorney",this.assignedAttorney),localStorage.setItem("newlawyer",this.newlawyer)},loadSelectedOptions(){const e=localStorage.getItem("assignedAttorney"),t=localStorage.getItem("newlawyer");null!==e&&null!==t&&(this.assignedAttorney=e,this.newlawyer=t)},clearLocalStorage(){localStorage.removeItem("assignedAttorney"),localStorage.removeItem("newlawyer")},completeNames(e){return`${e.nat_nombres} ${e.nat_apellido_paterno} ${e.nat_apellido_materno}`},badgeClass(e){return{"badge tramite p-2 rounded":"En Tramite"===e,"badge ejecucion p-2 rounded":"En Ejecucion"===e}},getPersonaName(e){return"natural"===e.tipo_persona?`${e.apellido_paterno} ${e.apellido_materno} ${e.nombres}`:e.razon_social},delay(e){return new Promise((t=>setTimeout(t,e)))},async listLawyers(){try{const e=await this.get({url:this.$store.getters.get__url+"/lawyer",token:this.$store.getters.get__token});this.lawyers=e.data,this.lawyersWithFiles=e.data.filter((e=>e.abo_carga_laboral>0)),console.log(this.lawyersWithFiles),console.log(e)}catch(e){console.error("Error al intentar obtener los datos",e)}},async listFiles(){console.log("abogado-asignado:",this.assignedAttorney);try{const e=await this.post({url:this.$store.getters.get__url+"/lawyer/expedientes",token:this.$store.getters.get__token,params:{abo_id:this.assignedAttorney}});this.saveSelectedOptions(),console.log("files",e),this.files=e.data,this.initDataTable()}catch(e){console.error(e)}},async saveChanges(){try{const e=this.files.map((e=>e.exp_id)),t=await this.post({url:this.$store.getters.get__url+"/lawyer/changeOfLawyer",token:this.$store.getters.get__token,params:{expedientes:e,abogado_actual:this.assignedAttorney,abogado_nuevo:this.newlawyer}});0==t.state?(this.assignedAttorney="default_value",this.newlawyer="default_value",await this.delay(500),console.log(t),await this.listLawyers(),await this.listFiles()):console.log(t)}catch(e){console.error(e)}},initDataTable(){this.dataTable&&this.dataTable.destroy(),this.$nextTick((()=>{this.dataTable=r()("#miTabla").DataTable({language:{url:"//cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json"}}),n().replace()}))}}},u=c,_=a(1001),g=(0,_.Z)(u,s,l,!1,null,"4e49d359",null),p=g.exports}}]);
//# sourceMappingURL=478.f67682df.js.map